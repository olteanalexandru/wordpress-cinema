!function($){function ectLoadMoreContent(thisEle,tempWrapper,type){var settingContainer=thisEle.parents(".ect-masonry-template-cont").find("#ect-lm-settings"),ajaxUrl=settingContainer.data("ajax-url"),settings=settingContainer.data("settings"),excludeEventsJson=settingContainer.attr("data-exclude-events"),loadMore=settingContainer.data("load-more"),loading=settingContainer.data("loading"),noEvent=settingContainer.data("loaded"),json_query=settingContainer.siblings("#ect-query-arg").html(),query=JSON.parse(json_query);if("loadmore"==type){thisEle.find(".ect-preloader").show(),thisEle.find("span").text(loading);var activeCat,catSlug=(activeCat=tempWrapper.find(".ect-categories li.ect-active")).attr("data-filter"),catEvents=activeCat.attr("data-posts"),catPages=activeCat.attr("data-pages"),paged=activeCat.attr("data-paged")}else{var activeCat,catSlug=(activeCat=thisEle).attr("data-filter"),catEvents=activeCat.attr("data-posts"),catPages=activeCat.attr("data-pages");settingContainer.find("#ect-cat-load-more").show();var paged=thisEle.attr("data-paged")}var data={action:"ect_catfilters_load_more",query:query,paged:paged,cat:catSlug,exclude_events:excludeEventsJson,"per-page":catEvents,settings:settings};return jQuery.post(ajaxUrl,data,(function(response){var rs=JSON.parse(response);"yes"==rs.events?setTimeout((function(){var content=rs.content;if($.each(content,(function(key,val){var html=$(val);tempWrapper.find(".ect-masonary-cont").append(html).masonry("appended",html,!0)})),paged=parseInt(paged)+1,rs.exclude_events){var oldlist=JSON.parse(excludeEventsJson);newExcludeList=oldlist.concat(JSON.parse(rs.exclude_events)),settingContainer.attr("data-exclude-events","["+newExcludeList+"]")}"loadmore"==type?(activeCat.attr("data-paged",paged),thisEle.find("span").text(loadMore),thisEle.find(".ect-preloader").hide()):(thisEle.attr("data-paged",paged),thisEle.attr("data-prefetch","true"),settingContainer.find("#ect-cat-load-more").hide(),catPages>0&&tempWrapper.find(".ect-masonay-load-more").find(".ect-load-more-btn").show()),masonryCustomCatColors(tempWrapper)}),1e3):(thisEle.find(".ect-preloader").hide(),thisEle.find("span").text(noEvent),setTimeout((function(){if("loadmore"==type)thisEle.hide().find("span").text(loadMore),settingContainer.find("#ect-cat-load-more").hide();else{var content=rs.content;thisEle.attr("data-prefetch","true"),settingContainer.find("#ect-cat-load-more").hide(),tempWrapper.find(".ect-masonay-load-more").find(".ect-load-more-btn").hide()}}),1500))})),!1}function masonryCustomCatColors(parentWrapper){parentWrapper.find(".ect-grid-event").each((function(){var element=$(this),bgcolor=element.data("cat-bgcolor"),txtcolor=element.data("cat-txtcolor");null!=bgcolor&&(element.find(".ect-event-category ul.tribe_events_cat li a").css({color:"#"+txtcolor,background:convertHex2("#"+bgcolor,.9),"border-color":"#"+bgcolor}),element.hasClass("style-1")?element.find(".ect-grid-date").css({background:convertHex2("#"+bgcolor,.95),"box-shadow":"none"}):element.hasClass("style-2")?element.find(".ect-grid-date").css({background:"#"+bgcolor,"box-shadow":"none"}):element.hasClass("style-3")&&(element.find(".ect-grid-event-area").css({background:"#"+bgcolor,"box-shadow":"none","border-color":"#"+bgcolor}),element.find(".ect-grid-event-area .ect-grid-title h4, .ect-grid-event-area a, .ect-grid-event-area .ect-venue-details, .ect-grid-event-area .ect-icon, .ect-grid-event-area .ect-rate").css({color:"#"+txtcolor}))),null!=txtcolor&&element.find(".ect-grid-date .ect-date-area").css({color:"#"+txtcolor})}))}function convertHex2(hex,opacity){return hex=hex.replace("#",""),r=parseInt(hex.substring(0,2),16),g=parseInt(hex.substring(2,4),16),b=parseInt(hex.substring(4,6),16),result="rgba("+r+","+g+","+b+","+opacity+")",result}jQuery(document).ready((function($){$(".ect-masonry-template-cont").each((function(){var tempWrapper=$(this),self=tempWrapper.find(".ect-masonary-cont");self.find(".ect-grid-event").first().addClass("grid-sizer"),self.imagesLoaded((function(){self.masonry({gutterWidth:15,isAnimated:!0,itemSelector:".ect-grid-event",columnWidth:".grid-sizer",percentPosition:!0})})),tempWrapper.find(".ect-categories li").click((function(e){e.preventDefault();var filter=$(this).attr("data-filter");self.masonryFilter({filter:function(){return!filter||$(this).attr("data-filter").includes(filter);var content}})})),tempWrapper.find(".ect-categories li").on("click",(function(){$(this).addClass("ect-active").siblings().removeClass("ect-active");var catEvents=$(this).attr("data-posts"),catPages=parseInt($(this).attr("data-pages")),thisEle=$(this),activeCat=thisEle.attr("data-filter"),prefetch;"false"==$(this).attr("data-prefetch")?($(".ect-masonay-load-more").find(".ect-load-more-btn").hide(),ectLoadMoreContent(thisEle,tempWrapper,"catcontent")):catPages>0&&$(".ect-masonay-load-more").find(".ect-load-more-btn").show()})),tempWrapper.find(".ect-masonay-load-more").find(".ect-load-more-btn").on("click",(function(){var thisEle;return ectLoadMoreContent($(this),tempWrapper,"loadmore"),!1}))}))}))}(jQuery);